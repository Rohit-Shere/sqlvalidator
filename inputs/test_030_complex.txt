SELECT 
    o.order_id,
    c.customer_name,
    COUNT(DISTINCT oi.item_id) as num_items,
    SUM(oi.quantity) as total_quantity
FROM orders o
LEFT JOIN customers c ON o.customer_id = c.customer_id
LEFT JOIN order_items oi ON o.order_id = oi.order_id
WHERE o.order_date BETWEEN '2025-01-01' AND '2025-12-31'
    AND c.country IN ('USA', 'Canada', 'Mexico')
GROUP BY o.order_id, c.customer_name
HAVING SUM(oi.quantity) > 10
ORDER BY total_quantity DESC
LIMIT 100;
